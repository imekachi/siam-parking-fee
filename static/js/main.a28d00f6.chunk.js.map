{"version":3,"sources":["operations/fee.js","utils.js","config/colors.js","config/park.js","config/chart.js","components/ParkingInfo.js","components/PopUpChoosePark.js","components/App.js","serviceWorker.js","index.js"],"names":["calculateFee","feeRates","value","parkedHrs","arguments","length","undefined","constructor","name","TypeError","concat","JSON","stringify","totalCost","hrsLeft","some","rate","index","costByRate","Math","ceil","hrs","cost","max","storage","key","store","data","prevData","this","getData","localStorage","setItem","Object","objectSpread","rawData","getItem","parsedData","parse","start","Date","reset","removeItem","COLORS","RED","ORANGE","YELLOW","GREEN","TEAL","BLUE","PURPLE","GRAY","GRID","parkConfig","MBK","color","CTW","SIAM_CEN","parkConfigEntries","entries","OVERVIEW_HOURS_ARRAY","Array","from","unused","feeOverview","values","map","park","label","hours","borderColor","backgroundColor","fill","chartData","labels","hour","datasets","chartOptions","maintainAspectRatio","tooltips","mode","intersect","itemSort","a","b","yLabel","hover","legend","position","boxWidth","padding","usePointStyle","scales","yAxes","gridLines","zeroLineColor","ticks","beginAtZero","xAxes","ParkingInfo","props","durationHrs","fee","isLive","onClickLiveButton","react_default","createElement","className","onClick","style","toLocaleString","currency","PopUpChoosePark","onChoosePark","onClickBackdrop","Fragment","_ref","_ref2","slicedToArray","info","data-park-id","defaultState","isChoosingPark","isRendered","App","_useState","useState","_useState2","state","setState","onClickReset","useEffect","_storage$getData2","parkId","storageIsLive","timeoutId","parkInfo","updateState","_ref$isLive","currentDuration","dateStart","dateEnd","abs","getDurationHrs","setTimeout","clearTimeout","es","options","height","components_ParkingInfo","assign","startTime","components_PopUpChoosePark","event","target","dataset","currentFee","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","components_App","document","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"uOAQO,SAASA,EAAaC,GAAyB,ICF9BC,EDEeC,EAAeC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAH,EACjD,KCHsBF,EDGTD,ICFsB,kBAAVC,GAAiD,UAA3BA,EAAMK,YAAYC,KDG/D,MAAM,IAAIC,UAAJ,4FAAAC,OACwFC,KAAKC,UAC/FX,KAMN,IAAIY,EAAY,EACZC,EAAUX,EA+Bd,OA5BAF,EAASc,KAAK,SAACC,EAAMC,GAEnB,GAAIH,GAAW,EAAG,OAAO,EAIzB,GAAIG,IAAUhB,EAASI,OAAS,EAAG,CAGjC,IACMa,EADYC,KAAKC,KAAKN,EAAUE,EAAKK,KACZL,EAAKM,KAMpC,OALAT,GAAaK,EACbJ,EAAU,GAIH,EAST,OALAD,GAAaG,EAAKM,KAElBR,EAAUK,KAAKI,IAAIT,EAAUE,EAAKK,IAAK,IAGhC,IAGFR,EAGF,IAAMW,EAAU,CACrBC,IAAK,qBACLC,MAAO,SAASC,GACd,IAAMC,EAAWC,KAAKC,UACtBC,aAAaC,QAAQH,KAAKJ,IAAKd,KAAKC,UAALqB,OAAAC,EAAA,EAAAD,CAAA,GAAoBL,EAAaD,MAElEG,QAAS,WACP,IAAMK,EAAUJ,aAAaK,QAAQP,KAAKJ,KAC1C,IAAKU,EAAS,MAAO,GAErB,IAAME,EAAa1B,KAAK2B,MAAMH,GAM9B,OAJIE,EAAWE,QACbF,EAAWE,MAAQ,IAAIC,KAAKH,EAAWE,QAGlCF,GAETI,MAAO,WACLV,aAAaW,WAAWb,KAAKJ,OE5DlBkB,EAZA,CACbC,IAAK,UACLC,OAAQ,UACRC,OAAQ,UACRC,MAAO,UACPC,KAAM,UACNC,KAAM,UACNC,OAAQ,UACRC,KAAM,UACNC,KAAM,4BCPKC,EAAa,CACxBC,IAAK,CACH9C,KAAM,MACN+C,MAAOZ,EAAOC,IACd3C,SAAU,CAAC,CAAEoB,IAAK,EAAGC,KAAM,IAAM,CAAED,IAAK,EAAGC,KAAM,MAEnDkC,IAAK,CACHhD,KAAM,MACN+C,MAAOZ,EAAOM,KACdhD,SAAU,CAAC,CAAEoB,IAAK,EAAGC,KAAM,IAAM,CAAED,IAAK,EAAGC,KAAM,MAEnDmC,SAAU,CACRjD,KAAM,cACN+C,MAAOZ,EAAOI,MACd9C,SAAU,CAAC,CAAEoB,IAAK,EAAGC,KAAM,IAAM,CAAED,IAAK,EAAGC,KAAM,OAIxCoC,EAAoBzB,OAAO0B,QAAQN,GCdnCO,EAAuBC,MAAMC,KAExC,CAAEzD,OAJuB,GAOzB,SAAC0D,EAAQ9C,GAAT,OAAmBA,EAAQ,IAOhB+C,EAAc/B,OAAOgC,OAAOZ,GAAYa,IAAI,SAAAC,GACvD,MAAO,CACLC,MAAOD,EAAK3D,KACZmB,KAAMiC,EAAqBM,IAAI,SAAAG,GAAK,OAAIrE,EAAamE,EAAKlE,SAAUoE,KACpEC,YAAaH,EAAKZ,MAClBgB,gBAAiBJ,EAAKZ,MACtBiB,MAAM,KAIGC,EAAY,CACvBC,OAAQd,EAAqBM,IAAI,SAAAS,GAAI,SAAAjE,OAAOiE,EAAP,OAAAjE,OAAiBiE,EAAO,EAAI,IAAM,MACvEC,SAAUZ,GAGCa,EAAe,CAC1BC,qBAAqB,EACrBC,SAAU,CAERC,KAAM,QACNC,WAAW,EAEXC,SAAU,SAACC,EAAGC,GAAJ,OAAUD,EAAEE,OAASD,EAAEC,SAEnCC,MAAO,CACLN,KAAM,UACNC,WAAW,GAEbM,OAAQ,CACNC,SAAU,SACVd,OAAQ,CACNe,SAAU,EACVC,QAAS,GACTC,eAAe,IAGnBC,OAAQ,CACNC,MAAO,CACL,CACEC,UAAW,CACTvC,MAAOZ,EAAOS,KACd2C,cAAepD,EAAOS,MAExB4C,MAAO,CACLC,aAAa,KAInBC,MAAO,CACL,CACEJ,UAAW,CACTvC,MAAOZ,EAAOS,wBC5BT+C,MApCf,SAAqBC,GAAO,IAClB5F,EAAoE4F,EAApE5F,KAAM+C,EAA8D6C,EAA9D7C,MAAOhB,EAAuD6D,EAAvD7D,MAAO8D,EAAgDD,EAAhDC,YAAaC,EAAmCF,EAAnCE,IAAKC,EAA8BH,EAA9BG,OAAQC,EAAsBJ,EAAtBI,kBACtD,OACEC,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,0BACbF,EAAAtB,EAAAuB,cAAA,UAAQC,UAAS,cAAAjG,OAAgB6F,EAAS,SAAW,IAAMK,QAASJ,GAApE,QAGAC,EAAAtB,EAAAuB,cAAA,MAAIC,UAAU,aAAaE,MAAO,CAAEtD,MAAOA,IACxC/C,GAEHiG,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,oBACbF,EAAAtB,EAAAuB,cAAA,QAAMC,UAAU,SAAhB,aADF,IAC2CF,EAAAtB,EAAAuB,cAAA,cAASnE,EAAMuE,mBAE1DL,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,uBACbF,EAAAtB,EAAAuB,cAAA,QAAMC,UAAU,SAAhB,aADF,IAC2CF,EAAAtB,EAAAuB,cAAA,cAASL,EAAYS,iBAArB,SAE3CL,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,kBACbF,EAAAtB,EAAAuB,cAAA,QAAMC,UAAU,SAAhB,WACAF,EAAAtB,EAAAuB,cAAA,QAAMC,UAAU,MAAME,MAAO,CAAEtD,MAAOZ,EAAOI,QAC1CuD,EAAIQ,eAAe,QAAS,CAAED,MAAO,WAAYE,SAAU,mBCUvDC,MA7Bf,SAAyBZ,GAAO,IACtBa,EAAkCb,EAAlCa,aAAcC,EAAoBd,EAApBc,gBACtB,OACET,EAAAtB,EAAAuB,cAAAD,EAAAtB,EAAAgC,SAAA,KACEV,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,WAAWC,QAASM,IACnCT,EAAAtB,EAAAuB,cAAA,WAASC,UAAU,SACjBF,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,gBAAf,6BACAF,EAAAtB,EAAAuB,cAAA,MAAIC,UAAU,aACXjD,EAAkBQ,IAAI,SAAAkD,GAAA,IAAAC,EAAApF,OAAAqF,EAAA,EAAArF,CAAAmF,EAAA,GAAE3F,EAAF4F,EAAA,GAAOE,EAAPF,EAAA,UACrBZ,EAAAtB,EAAAuB,cAAA,MACEjF,IAAKA,EACL+F,eAAc/F,EACdkF,UAAU,oCACVC,QAASK,GAERM,EAAK/G,YCTdiH,EAAe,CAAEC,gBAAgB,EAAOC,YAAY,GA4I3CC,MA1If,WAAe,IAAAC,EACaC,mBAASL,GADtBM,EAAA9F,OAAAqF,EAAA,EAAArF,CAAA4F,EAAA,GACNG,EADMD,EAAA,GACCE,EADDF,EAAA,GAsCPG,EAAe,WAAM,IAEjB3B,EAAW/E,EAAQM,UAAnByE,OACR/E,EAAQiB,QAERjB,EAAQE,MAAM,CAAE6E,WAChB0B,EAASR,IAoDX,OAtCAU,oBAAU,WAAM,IAAAC,EACmC5G,EAAQM,UAAjDS,EADM6F,EACN7F,MAAO8F,EADDD,EACCC,OAAgBC,EADjBF,EACS7B,OACvB,GAAKhE,EAAL,CAEA,IAqBIgG,EArBEC,EAAWnF,EAAWgF,GAKtBI,EAAc,WAAoC,IAAAC,GAAAtI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,IAA1BmG,cAAiC,IAAAmC,EAAxBV,EAAMzB,OAAkBmC,EAChDC,EN/DL,SAAwBC,GAAiC,IAAtBC,EAAsBzI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAZ,IAAIoC,KAGtD,OAFyBrB,KAAK2H,IAAID,EAAUD,GAElB,IAAO,GAAK,GM4DVG,CAAexG,GACvC0F,EAAShG,OAAAC,EAAA,EAAAD,CAAA,GACJ+F,EADG,CAENzB,SACAoB,YAAY,EACZxD,KAAM,CACJ5B,QACA/B,KAAMgI,EAAShI,KACf+C,MAAOiF,EAASjF,MAChB8C,YAAasC,EACbrC,IAAKtG,EAAawI,EAASvI,SAAU0I,QAa3C,OAPIX,EAAMzB,OACRgC,EAAYS,WAAWP,EAAa,KAC1BT,EAAML,YAEhBc,EAAY,CAAElC,OAAQ+B,IAGjB,WACLW,aAAaV,MAEd,CAACP,IAGFvB,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,OACbF,EAAAtB,EAAAuB,cAAA,MAAIC,UAAU,UAAd,oBAEAF,EAAAtB,EAAAuB,cAAA,OAAKC,UAAU,mBACbF,EAAAtB,EAAAuB,cAACwC,EAAA,EAAD,CAAMvH,KAAM8C,EAAW0E,QAAStE,EAAcuE,OAAQ,OAIvDpB,EAAM7D,KACLsC,EAAAtB,EAAAuB,cAAAD,EAAAtB,EAAAgC,SAAA,KACEV,EAAAtB,EAAAuB,cAAC2C,EAADpH,OAAAqH,OAAA,GACMtB,EAAM7D,KADZ,CAEEoC,OAAQyB,EAAMzB,OACdC,kBA/DgB,WAExB,IAAMD,GAAUyB,EAAMzB,OAEtB/E,EAAQE,MAAM,CAAE6E,WAEhB0B,EAAShG,OAAAC,EAAA,EAAAD,CAAA,GAAK+F,EAAN,CAAazB,gBA2DfE,EAAAtB,EAAAuB,cAAA,UACEC,UAAU,kBACVE,MAAO,CAAEtC,gBAAiB5B,EAAOG,QACjC8D,QAASsB,GAETzB,EAAAtB,EAAAuB,cAAA,KAAGC,UAAU,kBAAb,UALF,UASFF,EAAAtB,EAAAuB,cAAA,UACEC,UAAU,qCACVE,MAAO,CAAEtC,gBAAiB5B,EAAOO,QACjC0D,QAzHY,WAClBqB,EAAShG,OAAAC,EAAA,EAAAD,CAAA,GACJ+F,EADG,CAENuB,UAAW,IAAI/G,KACfkF,gBAAgB,OAuHZjB,EAAAtB,EAAAuB,cAAA,KAAGC,UAAU,kBAAb,kBALF,QAUDqB,EAAMN,gBACLjB,EAAAtB,EAAAuB,cAAC8C,EAAD,CAAiBvC,aAzHF,SAAAwC,GACnB,IACMpB,EADUoB,EAAMC,OACCC,QAAQtB,OAGzBlE,EAAOd,EAAWgF,GAGxB7G,EAAQE,MAAM,CAAEa,MAAOyF,EAAMuB,UAAWlB,WAExC,IAEMuB,EAAa5J,EAAamE,EAAKlE,SAFb,MAIxBgI,EAAShG,OAAAC,EAAA,EAAAD,CAAA,GACJ+F,EADG,CAEN7D,KAAM,CACJ5B,MAAOyF,EAAMuB,UACb/I,KAAM2D,EAAK3D,KACX+C,MAAOY,EAAKZ,MACZ8C,YAVoB,KAWpBC,IAAKsD,GAEPlC,gBAAgB,MAkG+BR,gBAAiBgB,MCrIhE2B,EAAcC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MAAM,2DAqCnC,SAASC,EAAgBC,EAAOC,GAC9BC,UAAUC,cACPC,SAASJ,GACTK,KAAK,SAAAC,GAEJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiB5C,QACfsC,UAAUC,cAAcQ,YAI1BC,QAAQC,IACN,iHAKEZ,GAAUA,EAAOa,UACnBb,EAAOa,SAASR,KAMlBM,QAAQC,IAAI,sCAGRZ,GAAUA,EAAOc,WACnBd,EAAOc,UAAUT,UAO5BU,MAAM,SAAAC,GACLL,QAAQK,MAAM,4CAA6CA,KCzFjEC,IAASC,OAAO9E,EAAAtB,EAAAuB,cAAC8E,EAAD,MAASC,SAASC,eAAe,SDc1C,SAAkBrB,GACvB,GAA6C,kBAAmBC,UAAW,CAGzE,GADkB,IAAIqB,IAAIC,oBAAwB7B,OAAOC,SAAS6B,MACpDC,SAAW/B,OAAOC,SAAS8B,OAIvC,OAGF/B,OAAOgC,iBAAiB,OAAQ,WAC9B,IAAM3B,EAAK,GAAA1J,OAAMkL,oBAAN,sBAEP/B,GAiEV,SAAiCO,EAAOC,GAEtC2B,MAAM5B,GACHK,KAAK,SAAAwB,GAEJ,IAAMC,EAAcD,EAASE,QAAQC,IAAI,gBAEnB,MAApBH,EAASI,QACO,MAAfH,IAA8D,IAAvCA,EAAYI,QAAQ,cAG5ChC,UAAUC,cAAcgC,MAAM9B,KAAK,SAAAC,GACjCA,EAAa8B,aAAa/B,KAAK,WAC7BV,OAAOC,SAASyC,aAKpBtC,EAAgBC,EAAOC,KAG1Be,MAAM,WACLJ,QAAQC,IAAI,mEArFVyB,CAAwBtC,EAAOC,GAI/BC,UAAUC,cAAcgC,MAAM9B,KAAK,WACjCO,QAAQC,IACN,gHAMJd,EAAgBC,EAAOC,MCrC/BE","file":"static/js/main.a28d00f6.chunk.js","sourcesContent":["import { isArray } from '../utils'\n\n/**\n * calculate parking fee\n *\n * @param {Array.<{hrs: number, cost: number}>} feeRates\n * @param {number} [parkedHrs = 1]\n */\nexport function calculateFee(feeRates, parkedHrs = 1) {\n  if (!isArray(feeRates)) {\n    throw new TypeError(\n      `Error! \"feeRates\" argument for \"calculateFee()\" should be an array, instead it receives, ${JSON.stringify(\n        feeRates\n      )}`\n    )\n  }\n\n  // Initialize values\n  let totalCost = 0\n  let hrsLeft = parkedHrs\n\n  // use .some to break instead of forEach that cannot be stopped\n  feeRates.some((rate, index) => {\n    // Stop the loop when there is no hrsLeft\n    if (hrsLeft <= 0) return true\n\n    // if the rate is the last one,\n    // we'll use that rate for the rest of hr left.\n    if (index === feeRates.length - 1) {\n      // Most parking fee will think that fragment of an hour is full one hour,\n      // and we can achieve that by using Math.ceil\n      const hrsFactor = Math.ceil(hrsLeft / rate.hrs)\n      const costByRate = hrsFactor * rate.cost\n      totalCost += costByRate\n      hrsLeft = 0\n\n      // stop any further operation,\n      // because at this the last item and we should get our answer.\n      return true\n    }\n\n    // add cost of the rate to total cost\n    totalCost += rate.cost\n    // minus hrsLeft and make sure hrsLeft won't go below zero\n    hrsLeft = Math.max(hrsLeft - rate.hrs, 0)\n\n    // continue the loop\n    return false\n  })\n\n  return totalCost\n}\n\nexport const storage = {\n  key: 'PARKING_TIME_START',\n  store: function(data) {\n    const prevData = this.getData()\n    localStorage.setItem(this.key, JSON.stringify({ ...prevData, ...data }))\n  },\n  getData: function() {\n    const rawData = localStorage.getItem(this.key)\n    if (!rawData) return {}\n\n    const parsedData = JSON.parse(rawData)\n\n    if (parsedData.start) {\n      parsedData.start = new Date(parsedData.start)\n    }\n\n    return parsedData\n  },\n  reset: function() {\n    localStorage.removeItem(this.key)\n  },\n}\n","/**\n * Check if the value is an array\n *\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return !!value && typeof value === 'object' && value.constructor.name === 'Array'\n}\n\n/**\n * Get duration between two date objects\n * NOTE: the duration will always be positive, which mean the arguments order won't affect the result\n *\n * @param {Date} dateStart\n * @param {Date} [dateEnd = new Date()]\n * @returns {number} duration\n */\nexport function getDurationHrs(dateStart, dateEnd = new Date()) {\n  const durationMillisec = Math.abs(dateEnd - dateStart)\n  // convert milliseconds to hours\n  return durationMillisec / 1000 / 60 / 60\n}\n","const COLORS = {\n  RED: '#ff4a48',\n  ORANGE: '#ff9f40',\n  YELLOW: '#ffcd56',\n  GREEN: '#7ad461',\n  TEAL: '#4bc0c0',\n  BLUE: '#36a2eb',\n  PURPLE: '#9966ff',\n  GRAY: '#c9cbcf',\n  GRID: 'rgba(255, 255, 255, 0.1)',\n}\n\nexport default COLORS\n","import COLORS from './colors'\n\nexport const parkConfig = {\n  MBK: {\n    name: 'MBK',\n    color: COLORS.RED,\n    feeRates: [{ hrs: 2, cost: 10 }, { hrs: 1, cost: 10 }],\n  },\n  CTW: {\n    name: 'CTW',\n    color: COLORS.BLUE,\n    feeRates: [{ hrs: 4, cost: 10 }, { hrs: 1, cost: 20 }],\n  },\n  SIAM_CEN: {\n    name: 'Siam Center',\n    color: COLORS.GREEN,\n    feeRates: [{ hrs: 4, cost: 10 }, { hrs: 1, cost: 20 }],\n  },\n}\n\nexport const parkConfigEntries = Object.entries(parkConfig)\n","import { calculateFee } from '../operations/fee'\nimport COLORS from './colors'\nimport { parkConfig } from './park'\n\nconst MAX_OVERVIEW_HOURS = 8\n\nexport const OVERVIEW_HOURS_ARRAY = Array.from(\n  // make array-like object that have specific length property\n  { length: MAX_OVERVIEW_HOURS },\n  // map function to create the array using index + 1\n  // which will result in an array starting from 1 to array length\n  (unused, index) => index + 1\n)\n/**\n * This data shows parking fee of each place for each hour you parked\n * { placeName: [array of fee by hours of parking] }\n * @type {Object}\n */\nexport const feeOverview = Object.values(parkConfig).map(park => {\n  return {\n    label: park.name,\n    data: OVERVIEW_HOURS_ARRAY.map(hours => calculateFee(park.feeRates, hours)),\n    borderColor: park.color,\n    backgroundColor: park.color,\n    fill: false,\n  }\n})\n\nexport const chartData = {\n  labels: OVERVIEW_HOURS_ARRAY.map(hour => `${hour} hr${hour > 1 ? 's' : ''}`),\n  datasets: feeOverview,\n}\n\nexport const chartOptions = {\n  maintainAspectRatio: false,\n  tooltips: {\n    // show all parking fee at the hour\n    mode: 'index',\n    intersect: false,\n    // put cheaper parking to be displayed first\n    itemSort: (a, b) => a.yLabel - b.yLabel,\n  },\n  hover: {\n    mode: 'nearest',\n    intersect: true,\n  },\n  legend: {\n    position: 'bottom',\n    labels: {\n      boxWidth: 5,\n      padding: 20,\n      usePointStyle: true,\n    },\n  },\n  scales: {\n    yAxes: [\n      {\n        gridLines: {\n          color: COLORS.GRID,\n          zeroLineColor: COLORS.GRID,\n        },\n        ticks: {\n          beginAtZero: true,\n        },\n      },\n    ],\n    xAxes: [\n      {\n        gridLines: {\n          color: COLORS.GRID,\n        },\n      },\n    ],\n  },\n}\n","import PropTypes from 'prop-types'\r\nimport React from 'react'\r\nimport COLORS from '../config/colors'\r\nimport './ParkInfo.css'\r\n\r\nfunction ParkingInfo(props) {\r\n  const { name, color, start, durationHrs, fee, isLive, onClickLiveButton } = props\r\n  return (\r\n    <div className=\"parking-info-container\">\r\n      <button className={`live-button${isLive ? ' -live' : ''}`} onClick={onClickLiveButton}>\r\n        LIVE\r\n      </button>\r\n      <h2 className=\"parking-at\" style={{ color: color }}>\r\n        {name}\r\n      </h2>\r\n      <div className=\"park-info -start\">\r\n        <span className=\"label\">Check-in:</span> <strong>{start.toLocaleString()}</strong>\r\n      </div>\r\n      <div className=\"park-info -duration\">\r\n        <span className=\"label\">Duration:</span> <strong>{durationHrs.toLocaleString()} hrs</strong>\r\n      </div>\r\n      <div className=\"park-info -fee\">\r\n        <span className=\"label\">Total: </span>\r\n        <span className=\"fee\" style={{ color: COLORS.GREEN }}>\r\n          {fee.toLocaleString('en-TH', { style: 'currency', currency: 'THB' })}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nParkingInfo.propTypes = {\r\n  name: PropTypes.string.isRequired,\r\n  color: PropTypes.string.isRequired,\r\n  start: PropTypes.instanceOf(Date).isRequired,\r\n  durationHrs: PropTypes.number.isRequired,\r\n  fee: PropTypes.number.isRequired,\r\n  isLive: PropTypes.bool,\r\n  onClickLiveButton: PropTypes.func,\r\n}\r\n\r\nexport default ParkingInfo\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { parkConfigEntries } from '../config/park'\r\nimport './PopUpChoosePark.css'\r\n\r\nfunction PopUpChoosePark(props) {\r\n  const { onChoosePark, onClickBackdrop } = props\r\n  return (\r\n    <>\r\n      <div className=\"backdrop\" onClick={onClickBackdrop} />\r\n      <section className=\"popup\">\r\n        <div className=\"popup-header\">Where are you parking at?</div>\r\n        <ul className=\"park-list\">\r\n          {parkConfigEntries.map(([key, info]) => (\r\n            <li\r\n              key={key}\r\n              data-park-id={key}\r\n              className=\"park-list-item _prevent-selection\"\r\n              onClick={onChoosePark}\r\n            >\r\n              {info.name}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </section>\r\n    </>\r\n  )\r\n}\r\n\r\nPopUpChoosePark.propTypes = {\r\n  onChoosePark: PropTypes.func,\r\n  onClickBackdrop: PropTypes.func,\r\n}\r\n\r\nexport default PopUpChoosePark\r\n","import React, { useEffect, useState } from 'react'\nimport { Line } from 'react-chartjs-2'\nimport { chartData, chartOptions } from '../config/chart'\nimport COLORS from '../config/colors'\nimport { parkConfig } from '../config/park'\nimport { calculateFee, storage } from '../operations/fee'\nimport { getDurationHrs } from '../utils'\nimport './App.css'\nimport ParkingInfo from './ParkingInfo'\nimport PopUpChoosePark from './PopUpChoosePark'\n\nconst defaultState = { isChoosingPark: false, isRendered: false }\n\nfunction App() {\n  const [state, setState] = useState(defaultState)\n\n  const onClickPark = () => {\n    setState({\n      ...state,\n      startTime: new Date(), // record currentTime\n      isChoosingPark: true, // popup park choosing popup\n    })\n  }\n\n  const onChoosePark = event => {\n    const element = event.target\n    const parkId = element.dataset.parkId\n\n    // get parkInfo\n    const park = parkConfig[parkId]\n\n    // store it to storage\n    storage.store({ start: state.startTime, parkId })\n    // initialize currentDuration\n    const currentDuration = 0.001\n    // initialize currentFee\n    const currentFee = calculateFee(park.feeRates, currentDuration)\n\n    setState({\n      ...state,\n      park: {\n        start: state.startTime,\n        name: park.name,\n        color: park.color,\n        durationHrs: currentDuration,\n        fee: currentFee,\n      },\n      isChoosingPark: false,\n    })\n  }\n\n  const onClickReset = () => {\n    // we will remove storage data but we want to keep \"isLive\" setting\n    const { isLive } = storage.getData()\n    storage.reset()\n    // save \"isLive\" back into storage\n    storage.store({ isLive })\n    setState(defaultState)\n  }\n\n  const onClickLiveButton = () => {\n    // determine current state of isLive\n    const isLive = !state.isLive\n    // update isLive data in storage\n    storage.store({ isLive })\n    // update isLive data in react state\n    setState({ ...state, isLive })\n  }\n\n  // This intended to run on the first mount ONLY\n  // to display current park state if exist\n  useEffect(() => {\n    const { start, parkId, isLive: storageIsLive } = storage.getData()\n    if (!start) return undefined\n\n    const parkInfo = parkConfig[parkId]\n\n    // create update state function\n    // that receives option object\n    // with default value of isLive is from state\n    const updateState = ({ isLive = state.isLive } = {}) => {\n      const currentDuration = getDurationHrs(start)\n      setState({\n        ...state,\n        isLive,\n        isRendered: true,\n        park: {\n          start,\n          name: parkInfo.name,\n          color: parkInfo.color,\n          durationHrs: currentDuration,\n          fee: calculateFee(parkInfo.feeRates, currentDuration),\n        },\n      })\n    }\n\n    let timeoutId\n    if (state.isLive) {\n      timeoutId = setTimeout(updateState, 1000)\n    } else if (!state.isRendered) {\n      // first render only, use isLive from storage\n      updateState({ isLive: storageIsLive })\n    }\n\n    return () => {\n      clearTimeout(timeoutId)\n    }\n  }, [state])\n\n  return (\n    <div className=\"App\">\n      <h1 className=\"header\">Bike parking fee</h1>\n      {/* CHART */}\n      <div className=\"chart-container\">\n        <Line data={chartData} options={chartOptions} height={280} />\n      </div>\n\n      {/* PARK INFO */}\n      {state.park ? (\n        <>\n          <ParkingInfo\n            {...state.park}\n            isLive={state.isLive}\n            onClickLiveButton={onClickLiveButton}\n          />\n          <button\n            className=\"floating-button\"\n            style={{ backgroundColor: COLORS.YELLOW }}\n            onClick={onClickReset}\n          >\n            <i className=\"material-icons\">delete</i>Reset\n          </button>\n        </>\n      ) : (\n        <button\n          className=\"floating-button _prevent-selection\"\n          style={{ backgroundColor: COLORS.PURPLE }}\n          onClick={onClickPark}\n        >\n          <i className=\"material-icons\">directions_car</i>Park\n        </button>\n      )}\n\n      {/* POPUP to choose the park */}\n      {state.isChoosingPark && (\n        <PopUpChoosePark onChoosePark={onChoosePark} onClickBackdrop={onClickReset} />\n      )}\n    </div>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      // eslint-disable-next-line no-param-reassign\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.')\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './components/App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}