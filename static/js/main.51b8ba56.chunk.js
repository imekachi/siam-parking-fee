(this["webpackJsonpsiam-parking-fee"]=this["webpackJsonpsiam-parking-fee"]||[]).push([[0],{178:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(59),o=n.n(a),c=(n(67),n(3)),s=(n(68),{RED:"#ff4a48",ORANGE:"#ff9f40",YELLOW:"#ffcd56",GREEN:"#7ad461",TEAL:"#4bc0c0",BLUE:"#36a2eb",PURPLE:"#9966ff",GRAY:"#c9cbcf",GRID:"rgba(255, 255, 255, 0.1)"}),i=(n(69),{ICON:{name:"Icon Siam",color:s.PURPLE,feeRates:new Date>new Date("2021-01-31 23:59")?[{hrs:2,cost:0},{hrs:1,cost:20}]:[{hrs:6,cost:0},{hrs:1,cost:20}]},SAMYAN:{name:"SamYan Mitrtown",color:s.YELLOW,feeRates:[{hrs:2,cost:0},{hrs:1,cost:10},{hrs:1,cost:10},{hrs:1,cost:20}]},MBK:{name:"MBK",color:s.RED,feeRates:[{hrs:2,cost:10},{hrs:1,cost:10}]},CTW:{name:"CTW",color:s.BLUE,feeRates:[{hrs:4,cost:10},{hrs:1,cost:20}]},SIAM_CEN:{name:"Siam Center",color:s.GREEN,feeRates:[{hrs:2,cost:20},{hrs:1,cost:20}]}}),l=Object.entries(i),u=n(7);function f(e){return!!e&&"object"===typeof e&&"Array"===e.constructor.name}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!f(e))throw new TypeError('Error! "feeRates" argument for "calculateFee()" should be an array, instead it receives, '.concat(JSON.stringify(e)));var n=0,r=t;return e.some((function(t,a){if(r<=0)return!0;if(a===e.length-1){var o=Math.ceil(r/t.hrs)*t.cost;return n+=o,r=0,!0}return n+=t.cost,r=Math.max(r-t.hrs,0),!1})),n}var h={key:"PARKING_TIME_START",store:function(e){var t=this.getData();localStorage.setItem(this.key,JSON.stringify(Object(u.a)(Object(u.a)({},t),e)))},getData:function(){var e=localStorage.getItem(this.key);if(!e)return null;var t=JSON.parse(e);return t.start&&(t.start=new Date(t.start)),t},reset:function(){localStorage.removeItem(this.key)}};function v(e,t,n){var r=t-(e="number"===typeof e?e.toString():e).length;return r<=0?e:"".concat(n.repeat(r)).concat(e)}function b(e){var t=function(e){var t=function(t){var n=Math.trunc(e/t);return e-=n*t,n};return{hours:t(36e5),minutes:t(6e4),seconds:t(1e3)}}(e);return"".concat(v(t.hours,2,"0"),":").concat(v(t.minutes,2,"0"),":").concat(v(t.seconds,2,"0"))}var j=n(0);var g=function(e){var t=e.parkId,n=e.start,a=e.isLive,o=e.onClickLiveButton,l=i[t],u=l.color,f=l.name,h=l.feeRates,v=Object(r.useState)(!1),g=Object(c.a)(v,2),m=g[0],p=g[1],k=Object(r.useMemo)((function(){var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return Math.abs(t.getTime()-e.getTime())}(n),t=function(e){return e/1e3/60/60}(e);return{duration:e,fee:d(h,t)}}),[h,n,m]),O=k.duration,x=k.fee;return Object(r.useEffect)((function(){var e;return a&&(e=setTimeout((function(){p(!m)}),1e3)),function(){clearTimeout(e)}}),[a,m]),Object(j.jsxs)("div",{className:"parking-info-container",children:[Object(j.jsx)("button",{className:"live-button".concat(a?" -live":""),onClick:o,children:"LIVE"}),Object(j.jsx)("h2",{className:"parking-at",style:{color:u},children:f}),Object(j.jsxs)("div",{className:"park-info -start",children:[Object(j.jsx)("span",{className:"label",children:"Check-in:"})," ",Object(j.jsx)("strong",{children:n.toLocaleString()})]}),Object(j.jsxs)("div",{className:"park-info -duration",children:[Object(j.jsx)("span",{className:"label",children:"Duration:"})," ",Object(j.jsx)("strong",{children:b(O)})]}),Object(j.jsxs)("div",{className:"park-info -fee",children:[Object(j.jsx)("span",{className:"label",children:"Total: "}),Object(j.jsx)("span",{className:"fee",style:{color:s.GREEN},children:x.toLocaleString("en-TH",{style:"currency",currency:"THB"})})]})]})};n(71);var m=function(e){var t=e.onChoosePark,n=e.onClickBackdrop;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"backdrop",onClick:n}),Object(j.jsxs)("section",{className:"popup",children:[Object(j.jsx)("div",{className:"popup-header",children:"Where are you parking at?"}),Object(j.jsx)("ul",{className:"park-list",children:l.map((function(e){var n=Object(c.a)(e,2),r=n[0],a=n[1];return Object(j.jsx)("li",{"data-park-id":r,className:"park-list-item _prevent-selection",onClick:t,children:a.name},r)}))})]})]})},p=n(62),k=Array.from({length:8},(function(e,t){return t+1})),O=Object.values(i).map((function(e){return{label:e.name,data:k.map((function(t){return d(e.feeRates,t)})),borderColor:e.color,backgroundColor:e.color,fill:!1}})),x={labels:k.map((function(e){return"".concat(e," hr").concat(e>1?"s":"")})),datasets:O},N={maintainAspectRatio:!1,plugins:{tooltip:{mode:"index",intersect:!1,itemSort:function(e,t){return e.parsed.y-t.parsed.y}},legend:{position:"bottom",labels:{boxWidth:5,padding:20,usePointStyle:!0}}},hover:{mode:"nearest",intersect:!0},scales:{y:{beginAtZero:!0,grid:{color:s.GRID,borderColor:s.GRID}},x:{grid:{color:s.GRID,borderColor:s.GRID}}}};function L(){return Object(j.jsx)("div",{className:"chart-container",children:Object(j.jsx)(p.a,{data:x,options:N,height:280})})}function w(e){var t=e.onClick;return Object(j.jsxs)("button",{className:"floating-button _prevent-selection",style:{backgroundColor:s.PURPLE},onClick:t,children:[Object(j.jsx)("i",{className:"material-icons",children:"directions_car"}),"Park"]})}function I(e){var t=e.onClick;return Object(j.jsxs)("button",{className:"floating-button",style:{backgroundColor:s.YELLOW},onClick:t,children:[Object(j.jsx)("i",{className:"material-icons",children:"delete"}),"Reset"]})}function y(){var e=function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=t[0],a=t[1],o=Object(r.useCallback)((function(){var e=!n;h.store({isLive:e}),a(e)}),[n]);return{isLive:n,setIsLive:a,toggleIsLive:o}}(),t=e.isLive,n=e.setIsLive,a=e.toggleIsLive,o=Object(r.useState)(),s=Object(c.a)(o,2),i=s[0],l=s[1];Object(r.useEffect)((function(){var e,t=null!==(e=h.getData())&&void 0!==e?e:{},r=t.start,a=t.parkId,o=t.isLive;r&&a&&(n(!!o),l({parkId:a,start:r}))}),[n]);return{parkingInfo:i,isLive:t,toggleIsLive:a,savePark:function(e){var t={parkId:e,start:new Date};h.store({start:t.start,parkId:e}),l(t)},resetPark:function(){h.reset(),h.store({isLive:t}),l(void 0)}}}var C=function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=t[0],a=t[1],o=y(),s=o.parkingInfo,i=o.isLive,l=o.toggleIsLive,u=o.savePark,f=o.resetPark;return Object(j.jsxs)("main",{className:"App",children:[Object(j.jsx)("h1",{className:"header",children:"Bike parking fee"}),Object(j.jsx)(L,{}),s?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(g,{parkId:s.parkId,start:s.start,isLive:i,onClickLiveButton:l}),Object(j.jsx)(I,{onClick:f})]}):Object(j.jsx)(w,{onClick:function(){return a(!0)}}),n&&Object(j.jsx)(m,{onChoosePark:function(e){var t=e.target.dataset.parkId;a(!1),u(t)},onClickBackdrop:function(){return a(!1)}})]})},E=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(j.jsx)(C,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/siam-parking-fee",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/siam-parking-fee","/service-worker.js");E?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):R(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):R(t,e)}))}}()},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){}},[[178,1,2]]]);
//# sourceMappingURL=main.51b8ba56.chunk.js.map